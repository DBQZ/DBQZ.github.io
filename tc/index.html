<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>获取外链</title>
    <style>
        /* 可选的简单样式 */
        body { font-family: Arial, sans-serif; }
        button { margin-top: 1rem; }
    </style>
</head>
<body>
    <h2>外链</h2>
    <form id="uploadForm">
        <label for="imageUpload">选择图片:</label>
        <input type="file" id="imageUpload" name="file" accept="image/*">
        <button type="submit">上传图片</button>
    </form>
    <div id="resultArea" style="display:none;">
        <h2>图片外链:</h2>
        <p id="linkResult"></p>
    </div>

    <script>
        // 获取DOM元素引用
        const form = document.getElementById("uploadForm");
        const imageUpload = document.getElementById("imageUpload");
        const resultArea = document.getElementById("resultArea");
        const linkResult = document.getElementById("linkResult");

        // 处理表单提交事件
        form.addEventListener("submit", async function(event) {
            event.preventDefault(); // 阻止默认的表单提交行为

            // 检查是否有文件被选中
            if (!imageUpload.files.length) {
                alert("请先选择要上传的图片！");
                return;
            }

            // 创建FormData对象来存储文件数据
            const formData = new FormData();
            formData.append("file", imageUpload.files[0]);

            try {
                // 发送POST请求到API
                const response = await fetch("https://api.uomg.com/api/image.baidu", {
                    method: "POST",
                    body: formData,
                });

                // 解析JSON响应
                const data = await response.json();

                // 根据API返回的结果更新UI
                if (data.code === "1") {
                    resultArea.style.display = "block";
                    linkResult.textContent = `![](https://graph.baidu.com/${data.imgurl})`;
                } else {
                    alert(`上传失败: ${data.msg}`);
                }
            } catch (error) {
                console.error("An error occurred:", error);
                alert("发生错误，请稍后重试。");
            }
        });
    </script>
</body>
</html>